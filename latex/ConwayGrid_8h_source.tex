\hypertarget{ConwayGrid_8h_source}{}\doxysection{Conway\+Grid.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//}}
\DoxyCodeLine{2 \textcolor{comment}{// Created by martin on 2023-\/10-\/04.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef DT047GPROJECT\_CONWAY\_CONWAYGRID\_H}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define DT047GPROJECT\_CONWAY\_CONWAYGRID\_H}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <numeric>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{keyword}{namespace }conway \{}
\DoxyCodeLine{13     \textcolor{keyword}{using }coordinate\_type = int;}
\DoxyCodeLine{14 }
\DoxyCodeLine{15     \textcolor{keyword}{struct }\mbox{\hyperlink{structconway_1_1Rules}{Rules}}\{}
\DoxyCodeLine{16         \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} operator ()(\textcolor{keywordtype}{bool} isAlive, \textcolor{keywordtype}{int} neighbors);}
\DoxyCodeLine{17     \};}
\DoxyCodeLine{18     \textcolor{keyword}{struct }\mbox{\hyperlink{structconway_1_1point}{point}} \{}
\DoxyCodeLine{19         \mbox{\hyperlink{structconway_1_1point}{point}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{20         \mbox{\hyperlink{structconway_1_1point}{point}}(coordinate\_type x, coordinate\_type y) : x(x), y(y) \{}
\DoxyCodeLine{21         \}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23         coordinate\_type x;}
\DoxyCodeLine{24         coordinate\_type y;}
\DoxyCodeLine{25 }
\DoxyCodeLine{26         \mbox{\hyperlink{structconway_1_1point}{point}} offset(\mbox{\hyperlink{structconway_1_1point}{point}} p)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{27             \textcolor{keywordflow}{return} \{p.x + x, p.y + y\};}
\DoxyCodeLine{28         \}}
\DoxyCodeLine{29         \textcolor{keywordtype}{bool} operator == (\textcolor{keyword}{const} \mbox{\hyperlink{structconway_1_1point}{point}}\& p)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{30             \textcolor{keywordflow}{return} x == p.x \&\& y == p.y;}
\DoxyCodeLine{31         \}}
\DoxyCodeLine{32     \};}
\DoxyCodeLine{33     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Store>}
\DoxyCodeLine{34     \textcolor{keyword}{struct }\mbox{\hyperlink{structconway_1_1Grid}{Grid}} \{}
\DoxyCodeLine{35         \mbox{\hyperlink{structconway_1_1Rules}{Rules}} rules;}
\DoxyCodeLine{36 }
\DoxyCodeLine{37         Store storage;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39         \textcolor{keywordtype}{size\_t} getAliveNeighbors(\mbox{\hyperlink{structconway_1_1point}{point}} src)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{40             \textcolor{keywordflow}{return} std::accumulate(neighbors.begin(), neighbors.end(), \textcolor{keywordtype}{size\_t}(), [\textcolor{keyword}{this}, src](\textcolor{keywordtype}{size\_t} curr, \textcolor{keyword}{const} \mbox{\hyperlink{structconway_1_1point}{point}}\& p)\{}
\DoxyCodeLine{41                 return this-\/>isAlive(p.offset(src)) + curr;}
\DoxyCodeLine{42             \});}
\DoxyCodeLine{43         \}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{keywordtype}{bool} isAlive(\mbox{\hyperlink{structconway_1_1point}{point}} p)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{46             \textcolor{keywordflow}{return} storage.get(p.x, p.y);}
\DoxyCodeLine{47         \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{53         \textcolor{keywordtype}{bool} \mbox{\hyperlink{structconway_1_1Grid_aee1cef84327dad18bbd3c8b11b0d00b9}{tick}}()\{}
\DoxyCodeLine{54             Store temp = storage;}
\DoxyCodeLine{55             \textcolor{keyword}{auto} evolved = \textcolor{keyword}{false};}
\DoxyCodeLine{56             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} x = storage.min\_x() -\/ 1; x < storage.max\_x() + 1; x++)\{}
\DoxyCodeLine{57                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} y = storage.min\_y() -\/ 1; y < storage.max\_y() + 1; y++)\{}
\DoxyCodeLine{58                     \textcolor{keyword}{auto} n = getAliveNeighbors(\{x, y\});}
\DoxyCodeLine{59                     \textcolor{keyword}{auto} wasAlive = isAlive(\{x, y\});}
\DoxyCodeLine{60                     \textcolor{keyword}{auto} alive = rules(wasAlive, n);}
\DoxyCodeLine{61                     \textcolor{keywordflow}{if}(alive != wasAlive)\{}
\DoxyCodeLine{62                         evolved = \textcolor{keyword}{true};}
\DoxyCodeLine{63                         \textcolor{keywordflow}{if}(alive)\{}
\DoxyCodeLine{64                             temp.set(x, y);}
\DoxyCodeLine{65                         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{66                             temp.remove(x, y);}
\DoxyCodeLine{67                         \}}
\DoxyCodeLine{68                     \}}
\DoxyCodeLine{69                 \}}
\DoxyCodeLine{70             \}}
\DoxyCodeLine{71             storage = temp;}
\DoxyCodeLine{72             \textcolor{keywordflow}{return} evolved;}
\DoxyCodeLine{73         \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75         \textcolor{keywordtype}{void} setSize(coordinate\_type width, coordinate\_type height);}
\DoxyCodeLine{76 }
\DoxyCodeLine{77         \mbox{\hyperlink{structconway_1_1point}{point}} getSize() \textcolor{keyword}{const};}
\DoxyCodeLine{78     \textcolor{keyword}{private}:}
\DoxyCodeLine{79         std::vector<point> neighbors = \{\{-\/1, -\/1\}, \{0, -\/1\}, \{1, -\/1\}, \{-\/1, 0\}, \{1, 0\}, \{-\/1, 1\},}
\DoxyCodeLine{80                                         \{0, 1\}, \{1, 1\}\};}
\DoxyCodeLine{81     \};}
\DoxyCodeLine{82 \}}
\DoxyCodeLine{83 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//DT047GPROJECT\_CONWAY\_CONWAYGRID\_H}}

\end{DoxyCode}
