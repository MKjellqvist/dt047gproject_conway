\hypertarget{ConwayGrid_8h_source}{}\doxysection{Conway\+Grid.\+h}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//}}
\DoxyCodeLine{2 \textcolor{comment}{// Created by martin on 2023-\/10-\/04.}}
\DoxyCodeLine{3 \textcolor{comment}{//}}
\DoxyCodeLine{4 }
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef DT047GPROJECT\_CONWAY\_CONWAYGRID\_H}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define DT047GPROJECT\_CONWAY\_CONWAYGRID\_H}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <numeric>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{keyword}{namespace }conway \{}
\DoxyCodeLine{13     \textcolor{keyword}{using }coordinate\_type = int;}
\DoxyCodeLine{14 }
\DoxyCodeLine{21     \textcolor{keyword}{struct }\mbox{\hyperlink{structconway_1_1Rules}{Rules}}\{}
\DoxyCodeLine{22         \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} operator ()(\textcolor{keywordtype}{bool} isAlive, \textcolor{keywordtype}{int} neighbors);}
\DoxyCodeLine{23     \};}
\DoxyCodeLine{24     \textcolor{keyword}{struct }\mbox{\hyperlink{structconway_1_1point}{point}} \{}
\DoxyCodeLine{25         \mbox{\hyperlink{structconway_1_1point}{point}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{26         \mbox{\hyperlink{structconway_1_1point}{point}}(coordinate\_type x, coordinate\_type y) : x(x), y(y) \{}
\DoxyCodeLine{27         \}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29         coordinate\_type x;}
\DoxyCodeLine{30         coordinate\_type y;}
\DoxyCodeLine{31         \mbox{\hyperlink{structconway_1_1point}{point}} offset(\mbox{\hyperlink{structconway_1_1point}{point}} p)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{32             \textcolor{keywordflow}{return} \{p.x + x, p.y + y\};}
\DoxyCodeLine{33         \}}
\DoxyCodeLine{34         \textcolor{keywordtype}{bool} operator == (\textcolor{keyword}{const} \mbox{\hyperlink{structconway_1_1point}{point}}\& p)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{35             \textcolor{keywordflow}{return} x == p.x \&\& y == p.y;}
\DoxyCodeLine{36         \}}
\DoxyCodeLine{37     \};}
\DoxyCodeLine{38     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Store>}
\DoxyCodeLine{39     \textcolor{keyword}{struct }\mbox{\hyperlink{structconway_1_1Grid}{Grid}} \{}
\DoxyCodeLine{40         \mbox{\hyperlink{structconway_1_1Rules}{Rules}} rules;}
\DoxyCodeLine{41 }
\DoxyCodeLine{42         Store storage;}
\DoxyCodeLine{43 }
\DoxyCodeLine{44         \textcolor{keywordtype}{size\_t} getAliveNeighbors(\mbox{\hyperlink{structconway_1_1point}{point}} src)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{45             \textcolor{keywordflow}{return} std::accumulate(neighbors.begin(), neighbors.end(), \textcolor{keywordtype}{size\_t}(), [\textcolor{keyword}{this}, src](\textcolor{keywordtype}{size\_t} curr, \textcolor{keyword}{const} \mbox{\hyperlink{structconway_1_1point}{point}}\& p)\{}
\DoxyCodeLine{46                 return this-\/>isAlive(p.offset(src)) + curr;}
\DoxyCodeLine{47             \});}
\DoxyCodeLine{48         \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         \textcolor{keywordtype}{bool} isAlive(\mbox{\hyperlink{structconway_1_1point}{point}} p)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{51             \textcolor{keywordflow}{return} storage.get(p.x, p.y);}
\DoxyCodeLine{52         \}}
\DoxyCodeLine{53 }
\DoxyCodeLine{58         \textcolor{keywordtype}{bool} \mbox{\hyperlink{structconway_1_1Grid_aee1cef84327dad18bbd3c8b11b0d00b9}{tick}}()\{}
\DoxyCodeLine{59             Store temp = storage;}
\DoxyCodeLine{60             \textcolor{keyword}{auto} evolved = \textcolor{keyword}{false};}
\DoxyCodeLine{61             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} x = storage.min\_x() -\/ 1; x < storage.max\_x() + 1; x++)\{}
\DoxyCodeLine{62                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} y = storage.min\_y() -\/ 1; y < storage.max\_y() + 1; y++)\{}
\DoxyCodeLine{63                     \textcolor{keyword}{auto} n = getAliveNeighbors(\{x, y\});}
\DoxyCodeLine{64                     \textcolor{keyword}{auto} wasAlive = isAlive(\{x, y\});}
\DoxyCodeLine{65                     \textcolor{keyword}{auto} alive = rules(wasAlive, n);}
\DoxyCodeLine{66                     \textcolor{keywordflow}{if}(alive != wasAlive)\{}
\DoxyCodeLine{67                         evolved = \textcolor{keyword}{true};}
\DoxyCodeLine{68                         \textcolor{keywordflow}{if}(alive)\{}
\DoxyCodeLine{69                             temp.set(x, y);}
\DoxyCodeLine{70                         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{71                             temp.remove(x, y);}
\DoxyCodeLine{72                         \}}
\DoxyCodeLine{73                     \}}
\DoxyCodeLine{74                 \}}
\DoxyCodeLine{75             \}}
\DoxyCodeLine{76             storage = temp;}
\DoxyCodeLine{77             \textcolor{keywordflow}{return} evolved;}
\DoxyCodeLine{78         \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80         \textcolor{keywordtype}{void} setSize(coordinate\_type width, coordinate\_type height);}
\DoxyCodeLine{81 }
\DoxyCodeLine{82         \mbox{\hyperlink{structconway_1_1point}{point}} getSize() \textcolor{keyword}{const};}
\DoxyCodeLine{83     \textcolor{keyword}{private}:}
\DoxyCodeLine{84         std::vector<point> neighbors = \{\{-\/1, -\/1\}, \{0, -\/1\}, \{1, -\/1\}, \{-\/1, 0\}, \{1, 0\}, \{-\/1, 1\},}
\DoxyCodeLine{85                                         \{0, 1\}, \{1, 1\}\};}
\DoxyCodeLine{86     \};}
\DoxyCodeLine{87 \}}
\DoxyCodeLine{88 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//DT047GPROJECT\_CONWAY\_CONWAYGRID\_H}}

\end{DoxyCode}
